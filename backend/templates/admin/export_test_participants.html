{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
&rsaquo; <a href="{% url 'admin:students_student_changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
&rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<h1>{{ title }}</h1>

<div class="form-row">
    <div class="align-left">
        <p>テスト受講生徒の一覧をエクセルファイルでエクスポートします。年度と期間を選択してください。</p>
    </div>
</div>

<form action="" method="post">
    {% csrf_token %}
    
    <fieldset class="module aligned">
        <h2>エクスポート条件</h2>
        
        <div class="form-row">
            <div>
                <label for="id_year" class="required">年度:</label>
                <select name="year" id="id_year" required>
                    <option value="">年度を選択</option>
                    {% for year in years %}
                        <option value="{{ year.value }}">{{ year.label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        
        <div class="form-row">
            <div>
                <label for="id_period" class="required">期間:</label>
                <select name="period" id="id_period" required>
                    <option value="">期間を選択</option>
                    {% for period in periods %}
                        <option value="{{ period.value }}">{{ period.label }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </fieldset>
    
    <div class="submit-row">
        <input type="submit" value="エクスポート実行" class="default" />
        <a href="{% url 'admin:students_student_changelist' %}" class="button cancel-link">キャンセル</a>
    </div>
</form>

<div class="form-row">
    <div class="help">
        <p><strong>エクスポート内容:</strong></p>
        <ul>
            <li>塾ID・塾名・教室名・生徒ID・生徒名</li>
            <li>学年・年度・期間・受講開始日・アクティブ状態</li>
            <li>出席率・出席割合・科目別出欠状況</li>
        </ul>
        
        <p><strong>注意事項:</strong></p>
        <ul>
            <li>指定した年度・期間に該当する受講生徒のみが対象となります</li>
            <li>アクティブな受講情報のみが出力されます</li>
            <li>塾ID・教室ID・生徒IDの順でソートされます</li>
        </ul>
    </div>
</div>

<style>
.form-row select {
    min-width: 200px;
    padding: 5px;
    margin-left: 10px;
}

.help {
    background: #f8f8f8;
    border: 1px solid #ddd;
    padding: 15px;
    margin-top: 20px;
}

.help ul {
    margin: 5px 0 10px 20px;
}

.help li {
    margin: 3px 0;
}
</style>
{% endblock %}